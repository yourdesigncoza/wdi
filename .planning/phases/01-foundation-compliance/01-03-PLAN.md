---
phase: 01-foundation-compliance
plan: 03
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - frontend/package.json
  - frontend/tsconfig.json
  - frontend/vite.config.ts
  - frontend/index.html
  - frontend/src/main.tsx
  - frontend/src/App.tsx
  - frontend/src/index.css
  - frontend/src/services/api.ts
  - frontend/src/hooks/useConsent.ts
  - frontend/src/components/consent/ConsentProvider.tsx
  - frontend/src/components/consent/ConsentModal.tsx
  - frontend/src/components/common/PrivacyPolicy.tsx
  - frontend/src/components/common/InfoOfficerContact.tsx
autonomous: true

must_haves:
  truths:
    - "User sees blocking consent modal before any data collection"
    - "User can view privacy policy from consent modal"
    - "User can see Information Officer contact details"
    - "Consent acceptance stores token and dismisses modal"
    - "App blocks interaction until consent granted"
  artifacts:
    - path: "frontend/src/components/consent/ConsentModal.tsx"
      provides: "Blocking consent modal"
      contains: "ConsentModal"
    - path: "frontend/src/components/consent/ConsentProvider.tsx"
      provides: "Consent state context"
      contains: "ConsentProvider"
    - path: "frontend/src/hooks/useConsent.ts"
      provides: "Consent hook"
      exports: ["useConsent"]
    - path: "frontend/src/services/api.ts"
      provides: "API client"
      contains: "fetch"
  key_links:
    - from: "frontend/src/App.tsx"
      to: "frontend/src/components/consent/ConsentProvider.tsx"
      via: "context wrapper"
      pattern: "ConsentProvider"
    - from: "frontend/src/components/consent/ConsentModal.tsx"
      to: "frontend/src/services/api.ts"
      via: "consent API call"
      pattern: "api\\.consent"
---

<objective>
Create React frontend shell with blocking POPIA consent modal, privacy policy display, and Information Officer contact page.

Purpose: User-facing consent flow that blocks app access until POPIA consent is granted
Output: React app with consent modal, privacy policy, and info officer pages
</objective>

<execution_context>
@/home/laudes/.claude/get-shit-done/workflows/execute-plan.md
@/home/laudes/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-compliance/01-RESEARCH.md
@.planning/phases/01-foundation-compliance/01-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: React + Vite project with Tailwind</name>
  <files>
    frontend/package.json
    frontend/tsconfig.json
    frontend/vite.config.ts
    frontend/index.html
    frontend/src/main.tsx
    frontend/src/App.tsx
    frontend/src/index.css
  </files>
  <action>
    Create React frontend with Vite and Tailwind:

    1. Initialize with: `npm create vite@latest frontend -- --template react-ts`
    2. Install dependencies: `npm install @tanstack/react-query`
    3. Install Tailwind CSS 4: `npm install -D tailwindcss @tailwindcss/vite`

    **vite.config.ts:**
    - Add Tailwind plugin
    - Proxy /api to http://localhost:8000 for dev

    **index.css:**
    - Import Tailwind with @import "tailwindcss"

    **App.tsx:**
    - Wrap with QueryClientProvider and ConsentProvider
    - Render ConsentModal and placeholder main content
    - Show "Welcome to WillCraft SA" when consent granted

    **main.tsx:**
    - Standard React 19 createRoot setup
  </action>
  <verify>
    cd frontend && npm install && npm run dev &
    sleep 3
    curl http://localhost:5173 | grep -o "WillCraft"
    pkill -f "vite"
  </verify>
  <done>Vite dev server runs, Tailwind styles load, app renders</done>
</task>

<task type="auto">
  <name>Task 2: Consent provider and blocking modal</name>
  <files>
    frontend/src/services/api.ts
    frontend/src/hooks/useConsent.ts
    frontend/src/components/consent/ConsentProvider.tsx
    frontend/src/components/consent/ConsentModal.tsx
  </files>
  <action>
    Create consent flow components:

    **services/api.ts:**
    - Base API client with credentials: 'include' for cookies
    - Functions: checkConsentStatus(), grantConsent(categories), withdrawConsent()
    - getPrivacyPolicy(), getInfoOfficer()

    **hooks/useConsent.ts:**
    - Re-export useConsent from ConsentProvider context

    **components/consent/ConsentProvider.tsx:**
    - ConsentContext with hasConsent, isLoading, grantConsent, withdrawConsent
    - useEffect to check consent status on mount via API
    - grantConsent calls API and updates state on success

    **components/consent/ConsentModal.tsx:**
    - Fixed overlay (inset-0, bg-black/50, z-50) - BLOCKING, no close button
    - Modal card: white bg, rounded-lg, max-w-lg, centered
    - Title: "Privacy Consent Required"
    - Explanation: Plain language about POPIA, data use for will creation
    - Links: "Read our Privacy Policy" and "Contact Information Officer" (open in new tab or modal)
    - Two buttons: "I Accept" (primary, grants consent) and "Leave Site" (navigates away)
    - Loading state while submitting
    - Only renders when !hasConsent && !isLoading

    Follow RESEARCH.md React patterns. Use Tailwind for all styling.
  </action>
  <verify>
    Open http://localhost:5173 in browser
    Consent modal should block entire screen
    "Leave Site" should navigate away
    "I Accept" should call /api/consent and dismiss modal
  </verify>
  <done>Blocking modal appears on load, accept grants consent and dismisses, leave navigates away</done>
</task>

<task type="auto">
  <name>Task 3: Privacy policy and info officer pages</name>
  <files>
    frontend/src/components/common/PrivacyPolicy.tsx
    frontend/src/components/common/InfoOfficerContact.tsx
  </files>
  <action>
    Create POPIA-required information pages:

    **components/common/PrivacyPolicy.tsx:**
    - Full-page component (or modal) displaying privacy policy
    - Fetches from /api/privacy-policy on mount
    - Sections: What we collect, How we use it, Data retention, Your rights
    - Loading and error states
    - Back button or close handler

    **components/common/InfoOfficerContact.tsx:**
    - Displays Information Officer contact details
    - Fetches from /api/info-officer
    - Shows: Name, Email, Phone, Address
    - Link to submit data request (POST /api/data-request)
    - Simple form: request type dropdown (access/correction/deletion), description textarea, email input
    - Submit shows confirmation message

    These should be accessible from the consent modal links and from main app navigation.

    Update App.tsx to include basic routing (react-router-dom) or conditional rendering for these pages.
    Add react-router-dom if using routing: `npm install react-router-dom`
  </action>
  <verify>
    Navigate to /privacy-policy - should show policy
    Navigate to /info-officer - should show contact details and form
    Submit data request form - should show confirmation
  </verify>
  <done>Privacy policy displays, info officer contact shows, data request form submits successfully</done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run dev` starts Vite dev server
2. Opening http://localhost:5173 shows blocking consent modal
3. Modal cannot be dismissed except via "I Accept" or "Leave Site"
4. Clicking "I Accept" grants consent (check Network tab for POST /api/consent)
5. After consent, modal disappears and main content shows
6. Privacy policy link shows full policy text
7. Info officer link shows contact details and data request form
8. Refreshing page does NOT show modal again (consent persisted in cookie)
</verification>

<success_criteria>
- React app runs with Vite and Tailwind styling
- Blocking consent modal prevents app access until accepted
- Privacy policy page displays data handling explanation
- Information Officer contact page shows details
- Data request form allows users to submit access/correction/deletion requests
- Consent persists across page refreshes via cookie
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-compliance/01-03-SUMMARY.md`
</output>
